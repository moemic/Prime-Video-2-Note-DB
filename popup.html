<!doctype html>
<html lang="ja">

<head>
  <meta charset="utf-8" />
  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
      width: 380px;
      background: linear-gradient(135deg, #1a1d21 0%, #2d3239 100%);
      color: #e0e0e0;
      padding: 16px;
    }

    .header {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      margin-bottom: 16px;
      padding-bottom: 12px;
      border-bottom: 1px solid #3a3f47;
    }

    .header h1 {
      font-size: 14px;
      font-weight: 600;
      color: #4db8ff;
    }

    .cover-section {
      flex-direction: column;
      gap: 4px;
      margin-bottom: 16px;
    }

    .carousel-wrapper {
      display: flex;
      align-items: center;
      gap: 4px;
      width: 100%;
      height: 150px;
    }

    .carousel-viewport {
      flex: 1;
      height: 100%;
      overflow: hidden;
      border-radius: 6px;
      background: #3a3f47;
      position: relative;
    }

    .carousel-track {
      display: flex;
      height: 100%;
      transition: transform 0.3s ease;
    }

    .carousel-item {
      min-width: 120px;
      height: 100%;
      object-fit: contain;
      cursor: pointer;
      border: 3px solid transparent;
      opacity: 0.7;
      transition: all 0.2s;
      background: #222;
      border-radius: 4px;
    }

    .carousel-item:hover {
      opacity: 0.8;
    }

    .carousel-item.selected {
      border-color: #4db8ff;
      opacity: 1;
      z-index: 2;
    }

    .carousel-item.page-cover {
      border-color: #ff9800;
      opacity: 1;
      z-index: 2;
    }

    .carousel-item.selected.page-cover {
      border-color: #ff9800;
      box-shadow: 0 0 0 1px #4db8ff, 0 0 0 3px #ff9800;
    }

    .carousel-nav {
      width: 24px;
      height: 100%;
      background: #3a3f47;
      border: none;
      color: #e0e0e0;
      cursor: pointer;
      font-size: 12px;
      border-radius: 4px;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: background 0.2s;
    }

    .carousel-nav:hover {
      background: #4a5058;
    }

    .carousel-nav:disabled {
      opacity: 0.3;
      cursor: default;
    }

    .image-counter {
      width: 100%;
      text-align: right;
      font-size: 10px;
      color: #888;
      padding-right: 4px;
    }

    .image-selection-info {
      display: flex;
      justify-content: space-between;
      font-size: 10px;
      color: #888;
      padding: 2px 4px 0;
    }

    .image-selection-info .legend {
      display: flex;
      gap: 8px;
    }

    .legend-item {
      display: flex;
      align-items: center;
      gap: 3px;
    }

    .legend-dot {
      width: 8px;
      height: 8px;
      border-radius: 2px;
    }

    .legend-dot.blue { background: #4db8ff; }
    .legend-dot.orange { background: #ff9800; }


    .field {
      margin-bottom: 14px;
    }

    .field-label {
      font-size: 11px;
      color: #888;
      margin-bottom: 4px;
      display: block;
    }

    .field input,
    .field textarea {
      width: 100%;
      background: #3a3f47;
      border: 1px solid #4a5058;
      border-radius: 6px;
      padding: 10px 12px;
      color: #e0e0e0;
      font-size: 13px;
      transition: border-color 0.2s;
    }

    .field select,
    .field input[list] {
      width: 100%;
      background: #3a3f47;
      border: 1px solid #4a5058;
      border-radius: 6px;
      padding: 10px 12px;
      color: #e0e0e0;
      font-size: 13px;
      appearance: none;
      -webkit-appearance: none;
    }

    .field input[list] {
      background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 24 24' fill='none' stroke='%23888' stroke-width='3' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='6 9 12 15 18 9'%3E%3C/polyline%3E%3C/svg%3E");
      background-repeat: no-repeat;
      background-position: right 12px center;
    }

    .field input:focus,
    .field textarea:focus {
      outline: none;
      border-color: #4db8ff;
    }

    .field textarea {
      min-height: 60px;
      resize: vertical;
    }

    .rating-section {
      margin-bottom: 14px;
    }

    .rating-stars {
      display: flex;
      gap: 4px;
    }

    .star {
      font-size: 24px;
      cursor: pointer;
      color: #4a5058;
      transition: color 0.15s, transform 0.15s;
    }

    .star:hover {
      transform: scale(1.1);
    }

    .star.active {
      color: #ffd700;
    }

    .tags-input {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
      background: #3a3f47;
      border: 1px solid #4a5058;
      border-radius: 6px;
      padding: 8px;
      min-height: 40px;
    }

    .tag {
      background: var(--chip-bg, #4db8ff);
      color: var(--chip-fg, #1a1d21);
      border: 1px solid var(--chip-border, transparent);
      padding: 4px 8px;
      border-radius: 4px;
      font-size: 12px;
      display: flex;
      align-items: center;
      gap: 4px;
    }

    .tag .remove {
      cursor: pointer;
      font-weight: bold;
    }

    .suggested-tags {
      margin-top: 8px;
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
    }

    .tag-chip {
      background: var(--chip-bg, #2d3239);
      color: var(--chip-fg, #888);
      border: 1px solid var(--chip-border, #4a5058);
      padding: 4px 10px;
      border-radius: 12px;
      font-size: 11px;
      cursor: pointer;
      transition: all 0.2s;
    }

    .tag-chip:hover {
      filter: brightness(1.08);
    }

    .tag-chip.selected {
      background: var(--chip-selected-bg, rgba(77, 184, 255, 0.15));
      color: var(--chip-selected-fg, #4db8ff);
      border-color: var(--chip-selected-border, #4db8ff);
    }

    .tags-input input {
      flex: 1;
      min-width: 100px;
      background: transparent;
      border: none;
      color: #e0e0e0;
      font-size: 12px;
      padding: 4px;
    }

    .tags-input input:focus {
      outline: none;
    }

    .tags-input input::placeholder {
      color: #666;
    }

    .divider {
      height: 1px;
      background: #3a3f47;
      margin: 16px 0;
    }

    .attributes-header {
      font-size: 11px;
      color: #666;
      text-align: center;
      margin-bottom: 12px;
    }

    .save-btn {
      width: 100%;
      background: linear-gradient(135deg, #0099cc 0%, #007399 100%);
      color: white;
      border: none;
      border-radius: 8px;
      padding: 14px;
      font-size: 14px;
      font-weight: 600;
      cursor: pointer;
      transition: transform 0.1s, box-shadow 0.2s;
    }

    .save-btn:hover {
      transform: translateY(-1px);
      box-shadow: 0 4px 12px rgba(0, 153, 204, 0.3);
    }

    .save-btn:disabled {
      background: #4a5058;
      cursor: not-allowed;
      transform: none;
      box-shadow: none;
    }

    .duplicate-warning {
      display: none;
      background: rgba(255, 166, 0, 0.1);
      border: 1px solid #ffa600;
      color: #ffa600;
      padding: 8px 12px;
      border-radius: 6px;
      font-size: 11px;
      margin-top: 6px;
      line-height: 1.4;
    }

    .duplicate-warning a {
      color: #ffa600;
      text-decoration: underline;
      font-weight: 500;
    }

    .candidates-warning {
      display: none;
      background: rgba(77, 184, 255, 0.1);
      border: 1px solid #4db8ff;
      color: #4db8ff;
      padding: 8px 12px;
      border-radius: 6px;
      font-size: 11px;
      margin-top: 6px;
      line-height: 1.4;
    }

    .candidates-list {
      list-style: none;
      padding: 0;
      margin: 6px 0 0 0;
    }

    .candidate-item {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 4px 0;
      border-top: 1px solid rgba(77, 184, 255, 0.2);
    }

    .candidate-item a {
      color: #4db8ff;
      text-decoration: underline;
      font-weight: 500;
      flex: 1;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }

    .candidate-use-btn {
      background: rgba(77, 184, 255, 0.15);
      border: 1px solid #4db8ff;
      color: #4db8ff;
      border-radius: 4px;
      padding: 2px 8px;
      font-size: 10px;
      cursor: pointer;
      margin-left: 8px;
      white-space: nowrap;
      flex-shrink: 0;
    }

    .candidate-use-btn:hover {
      background: rgba(77, 184, 255, 0.3);
    }

    .overwrite-cover-label {
      display: flex;
      align-items: center;
      gap: 6px;
      margin-top: 6px;
      cursor: pointer;
      font-size: 11px;
      color: #ccc;
    }

    .overwrite-cover-label input[type="checkbox"] {
      accent-color: #4db8ff;
      cursor: pointer;
    }

    .status {
      text-align: center;
      font-size: 12px;
      margin-top: 10px;
      min-height: 18px;
    }

    .status.success {
      color: #4caf50;
    }

    .status.error {
      color: #f44336;
    }

    .status.loading {
      color: #4db8ff;
    }

    .settings-toggle {
      text-align: center;
      margin-top: 12px;
    }

    .settings-toggle a {
      color: #666;
      font-size: 11px;
      cursor: pointer;
      text-decoration: none;
    }

    .settings-toggle a:hover {
      color: #888;
    }

    .settings-panel {
      display: none;
      margin-top: 12px;
      padding-top: 12px;
      border-top: 1px solid #3a3f47;
    }

    .settings-panel.show {
      display: block;
    }

    .settings-panel .field input {
      font-size: 11px;
      padding: 8px;
    }
  </style>
</head>

<body>
  <div class="header">
    <span>ğŸ¬</span>
    <h1>Prime Video â†’ Notion</h1>
  </div>

  <div class="cover-section">
    <div class="carousel-wrapper">
      <button id="prevBtn" class="carousel-nav prev">â—€</button>
      <div class="carousel-viewport" id="carouselViewport">
        <div class="carousel-track" id="carouselTrack">
          <!-- Images injected here -->
        </div>
      </div>
      <button id="nextBtn" class="carousel-nav next">â–¶</button>
    </div>
    <div id="imgCounter" class="image-counter">0/0</div>
    <div class="image-selection-info">
      <div class="legend">
        <span class="legend-item"><span class="legend-dot blue"></span>ã‚¯ãƒªãƒƒã‚¯: ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£</span>
        <span class="legend-item"><span class="legend-dot orange"></span>å³ã‚¯ãƒªãƒƒã‚¯: ãƒšãƒ¼ã‚¸ã‚«ãƒãƒ¼</span>
      </div>
    </div>
  </div>

  <div class="field">
    <label class="field-label">Title</label>
    <input type="text" id="title" placeholder="ä½œå“ã‚¿ã‚¤ãƒˆãƒ«" />
    <div id="duplicateWarning" class="duplicate-warning">
      âš ï¸ ã™ã§ã«ç™»éŒ²ã•ã‚Œã¦ã„ã¾ã™ï¼š<a id="duplicateLink" target="_blank">Notionã‚’é–‹ã</a>
      <label id="overwriteCoverLabel" class="overwrite-cover-label">
        <input type="checkbox" id="overwriteCover" />
        ã‚«ãƒãƒ¼ç”»åƒã‚’ä¸Šæ›¸ãã™ã‚‹
      </label>
    </div>
    <div id="candidatesWarning" class="candidates-warning">
      ğŸ” ä¼¼ãŸä½œå“ãŒç™»éŒ²ã•ã‚Œã¦ã„ã¾ã™ï¼š
      <ul id="candidatesList" class="candidates-list"></ul>
    </div>
  </div>

  <div class="field">
    <label class="field-label">Tags</label>
    <div class="tags-input" id="tagsContainer">
      <input type="text" id="tagInput" placeholder="å…¥åŠ›ã—ã¦Enterã§è¿½åŠ " />
    </div>
    <div class="suggested-tags" id="suggestedTags">
      <!-- Suggested tags from Notion injected here -->
    </div>
  </div>

  <div class="field">
    <label class="field-label">Status</label>
    <div class="tags-input" id="statusContainer">
      <input type="text" id="statusInput" placeholder="å…¥åŠ›ã—ã¦Enterã§è¨­å®š" />
    </div>
    <div class="suggested-tags" id="suggestedStatuses">
      <!-- Suggested statuses injected here -->
    </div>
  </div>

  <div class="rating-section">
    <label class="field-label">Rating</label>
    <div class="rating-stars" id="ratingStars">
      <span class="star" data-value="1">â˜…</span>
      <span class="star" data-value="2">â˜…</span>
      <span class="star" data-value="3">â˜…</span>
      <span class="star" data-value="4">â˜…</span>
      <span class="star" data-value="5">â˜…</span>
    </div>
  </div>

  <div class="field">
    <label class="field-label">Note (æ¦‚è¦ãƒ»ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ä¿å­˜)</label>
    <textarea id="note" placeholder="ä½œå“ã®ã‚ã‚‰ã™ã˜ãªã©ï¼ˆãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã«ä¿å­˜ã•ã‚Œã¾ã™ï¼‰"></textarea>
  </div>

  <div class="field">
    <label class="field-label">Comment (æ„Ÿæƒ³ãƒ»ç´”æ­£ã‚³ãƒ¡ãƒ³ãƒˆæ©Ÿèƒ½ã¸)</label>
    <textarea id="comment" placeholder="ã‚ãªãŸã®æ„Ÿæƒ³ã‚’å…¥åŠ›...ï¼ˆãƒšãƒ¼ã‚¸ä¸Šéƒ¨ã®ã‚³ãƒ¡ãƒ³ãƒˆæ¬„ã«å…¥ã‚Šã¾ã™ï¼‰"></textarea>
  </div>

  <div class="divider"></div>

  <button class="save-btn" id="saveBtn">Notionã«ä¿å­˜</button>
  <p class="status" id="status"></p>

  <div class="settings-toggle">
    <a id="settingsToggle">âš™ï¸ Settings</a>
  </div>

  <div class="settings-panel" id="settingsPanel">
    <div style="font-size: 11px; color: #aaa; margin-bottom: 14px; line-height: 1.75; background: #23282f; padding: 10px 12px; border-radius: 6px; border-left: 3px solid #4db8ff;">
      <strong style="color: #e0e0e0;">âš™ï¸ åˆå›è¨­å®šãŒå¿…è¦ã§ã™</strong><br>
      ä»¥ä¸‹ã®2é …ç›®ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚<br>
      è©³ã—ã„æ‰‹é †ã¯ <strong style="color: #e0e0e0;">README</strong> ã®ã€Œã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—æ‰‹é †ã€ã‚’ã”è¦§ãã ã•ã„ã€‚
    </div>
    <div class="field">
      <label class="field-label">Notion Token <span style="font-weight:normal; color:#666;">â€” notion.so/profile/integrations ã§å–å¾—</span></label>
      <input type="password" id="token" placeholder="ntn_xxxxxxxxxxxxxxxx" />
    </div>
    <div class="field">
      <label class="field-label">Database ID <span style="font-weight:normal; color:#666;">â€” Notion DB ã‚’é–‹ã„ãŸ URL ã‹ã‚‰å–å¾—</span></label>
      <input type="text" id="db" placeholder="xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx" />
    </div>
    <div style="font-size: 10px; color: #666; text-align: right; margin-top: 8px;">version 1.20.0</div>
  </div>

  <script src="popup.js"></script>
</body>

</html>
